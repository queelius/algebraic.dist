<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multivariate and Mixture Distributions ‚Ä¢ algebraic.dist</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multivariate and Mixture Distributions">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">algebraic.dist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/algebra.html">Distribution Algebra with algebraic.dist</a>
    </li>
    <li>
      <a href="../articles/example.html">algebraic.dist: Examples</a>
    </li>
    <li>
      <a href="../articles/multivariate.html">Multivariate and Mixture Distributions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/queelius/algebraic.dist/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multivariate and Mixture Distributions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/algebraic.dist/blob/HEAD/vignettes/multivariate.Rmd" class="external-link"><code>vignettes/multivariate.Rmd</code></a></small>
      <div class="hidden name"><code>multivariate.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/algebraic.dist" class="external-link">algebraic.dist</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette covers the multivariate normal (MVN), affine
transformations, and mixture distribution facilities in
<code>algebraic.dist</code>. These features were introduced in version
0.3.0 and provide closed-form operations wherever possible, falling back
to Monte Carlo only when necessary.</p>
<div class="section level2">
<h2 id="mvn-basics">MVN Basics<a class="anchor" aria-label="anchor" href="#mvn-basics"></a>
</h2>
<p>Construct an MVN with <code><a href="../reference/mvn.html">mvn()</a></code>. The <code>mu</code>
argument is the mean vector and <code>sigma</code> is the
variance-covariance matrix (defaulting to the identity).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvn.html">mvn</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>         sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>,</span>
<span>                          <span class="fl">0.5</span>, <span class="fl">2.0</span>, <span class="fl">0.3</span>,</span>
<span>                          <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">1.5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">M</span></span>
<span><span class="co">#&gt; Multivariate normal distribution (3 dimensions) </span></span>
<span><span class="co">#&gt;   mu:</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span><span class="co">#&gt;   sigma:</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]  1.0  0.5  0.2</span></span>
<span><span class="co">#&gt; [2,]  0.5  2.0  0.3</span></span>
<span><span class="co">#&gt; [3,]  0.2  0.3  1.5</span></span></code></pre></div>
<p>Standard accessors return the moments and dimensionality.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]  1.0  0.5  0.2</span></span>
<span><span class="co">#&gt; [2,]  0.5  2.0  0.3</span></span>
<span><span class="co">#&gt; [3,]  0.2  0.3  1.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>The <code><a href="../reference/params.html">params()</a></code> generic flattens all parameters into a
single named vector (useful for optimisation interfaces).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt;    mu1    mu2    mu3 sigma1 sigma2 sigma3 sigma4 sigma5 sigma6 sigma7 sigma8 </span></span>
<span><span class="co">#&gt;    1.0    2.0    3.0    1.0    0.5    0.2    0.5    2.0    0.3    0.2    0.3 </span></span>
<span><span class="co">#&gt; sigma9 </span></span>
<span><span class="co">#&gt;    1.5</span></span></code></pre></div>
<div class="section level3">
<h3 id="sampling">Sampling<a class="anchor" aria-label="anchor" href="#sampling"></a>
</h3>
<p><code><a href="../reference/sampler.html">sampler()</a></code> returns a reusable sampling function. The
output is an n-by-d matrix where rows are observations and columns are
dimensions.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">samp</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 100   3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]     [,2]     [,3]</span></span>
<span><span class="co">#&gt; [1,]  2.2489225 1.535966 3.491808</span></span>
<span><span class="co">#&gt; [2,]  1.6922001 2.683528 2.965904</span></span>
<span><span class="co">#&gt; [3,]  2.6174451 2.400164 5.569057</span></span>
<span><span class="co">#&gt; [4,]  1.3945273 4.054878 5.919814</span></span>
<span><span class="co">#&gt; [5,] -0.4226174 1.308804 2.695016</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="marginals">Marginals<a class="anchor" aria-label="anchor" href="#marginals"></a>
</h3>
<p>Extracting a marginal over a subset of indices returns a new MVN (or
a univariate <code>normal</code> when a single index is selected).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M13</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marginal.html">marginal</a></span><span class="op">(</span><span class="va">M</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">M13</span></span>
<span><span class="co">#&gt; Multivariate normal distribution (2 dimensions) </span></span>
<span><span class="co">#&gt;   mu:</span></span>
<span><span class="co">#&gt; [1] 1 3</span></span>
<span><span class="co">#&gt;   sigma:</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]  1.0  0.2</span></span>
<span><span class="co">#&gt; [2,]  0.2  1.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M13</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">M13</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]  1.0  0.2</span></span>
<span><span class="co">#&gt; [2,]  0.2  1.5</span></span></code></pre></div>
<p>Selecting a single component yields a univariate normal.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marginal.html">marginal</a></span><span class="op">(</span><span class="va">M</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">M1</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 1, var = 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">M1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="closed-form-mvn-conditioning">Closed-Form MVN Conditioning<a class="anchor" aria-label="anchor" href="#closed-form-mvn-conditioning"></a>
</h2>
<p>Conditioning a multivariate normal on observed values uses the Schur
complement formula. Given an MVN partitioned into free variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>
and observed variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>2</mn></msub><mo>=</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">X_2 = a</annotation></semantics></math>,
the conditional distribution is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>‚à£</mo><msub><mi>X</mi><mn>2</mn></msub><mo>=</mo><mi>a</mi><mspace width="0.278em"></mspace><mo>‚àº</mo><mspace width="0.278em"></mspace><mi>ùí©</mi><mspace width="-0.167em"></mspace><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mi>Œº</mi><mn>1</mn></msub><mo>+</mo><msub><mi>Œ£</mi><mn>12</mn></msub><msubsup><mi>Œ£</mi><mn>22</mn><mrow><mo>‚àí</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>‚àí</mo><msub><mi>Œº</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.278em"></mspace><mspace width="0.278em"></mspace><msub><mi>Œ£</mi><mn>11</mn></msub><mo>‚àí</mo><msub><mi>Œ£</mi><mn>12</mn></msub><msubsup><mi>Œ£</mi><mn>22</mn><mrow><mo>‚àí</mo><mn>1</mn></mrow></msubsup><msub><mi>Œ£</mi><mn>21</mn></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">X_1 \mid X_2 = a \;\sim\; \mathcal{N}\!\bigl(\mu_1 + \Sigma_{12}\Sigma_{22}^{-1}(a - \mu_2),\;\; \Sigma_{11} - \Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21}\bigr)</annotation></semantics></math></p>
<p>This is exact ‚Äì no Monte Carlo is involved.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvn.html">mvn</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Condition on X2 = 1</span></span>
<span><span class="va">M_cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional.html">conditional</a></span><span class="op">(</span><span class="va">M2</span>, given_indices <span class="op">=</span> <span class="fl">2</span>, given_values <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M_cond</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">M_cond</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.36</span></span></code></pre></div>
<p>With
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\rho = 0.8</annotation></semantics></math>,
the conditional mean is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mn>1</mn></msub><mo>+</mo><mi>œÅ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>Œº</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn><mo>+</mo><mn>0.8</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\mu_1 + \rho(1 - \mu_2) = 0 + 0.8(1 - 0) = 0.8</annotation></semantics></math>,
and the conditional variance is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚àí</mo><msup><mi>œÅ</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>‚àí</mo><mn>0.64</mn><mo>=</mo><mn>0.36</mn></mrow><annotation encoding="application/x-tex">1 - \rho^2 = 1 - 0.64 = 0.36</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="predicate-based-mc-fallback">Predicate-based MC fallback<a class="anchor" aria-label="anchor" href="#predicate-based-mc-fallback"></a>
</h3>
<p>When the conditioning event is not ‚Äúobserve variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
at value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>‚Äù
but an arbitrary predicate, the package falls back to Monte Carlo. This
is accessed through the <code>P</code> argument.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">M_cond_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional.html">conditional</a></span><span class="op">(</span><span class="va">M2</span>, P <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M_cond_mc</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7938476 0.9969783</span></span></code></pre></div>
<p>The MC result is approximate and depends on the tolerance in the
predicate. Prefer the closed-form interface whenever possible.</p>
</div>
</div>
<div class="section level2">
<h2 id="affine-transformations">Affine Transformations<a class="anchor" aria-label="anchor" href="#affine-transformations"></a>
</h2>
<p><code>affine_transform(x, A, b)</code> computes the distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>A</mi><mi>X</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Y = AX + b</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>‚àº</mo><mtext mathvariant="normal">MVN</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œº</mi><mo>,</mo><mi>Œ£</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X \sim \text{MVN}(\mu, \Sigma)</annotation></semantics></math>.
The result is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>‚àº</mo><mtext mathvariant="normal">MVN</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mi>Œº</mi><mo>+</mo><mi>b</mi><mo>,</mo><mspace width="0.278em"></mspace><mspace width="0.278em"></mspace><mi>A</mi><mi>Œ£</mi><msup><mi>A</mi><mi>‚ä§</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y \sim \text{MVN}(A\mu + b,\;\; A \Sigma A^\top)</annotation></semantics></math></p>
<p>This is a closed-form operation that returns a new MVN (or
<code>normal</code> if the result is one-dimensional).</p>
<div class="section level3">
<h3 id="portfolio-example">Portfolio example<a class="anchor" aria-label="anchor" href="#portfolio-example"></a>
</h3>
<p>Consider two assets with expected returns and a covariance structure.
A portfolio is a linear combination of the returns.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvn.html">mvn</a></span><span class="op">(</span></span>
<span>  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.08</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.04</span>, <span class="fl">0.01</span>,</span>
<span>                   <span class="fl">0.01</span>, <span class="fl">0.09</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 60/40 portfolio weights</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.4</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">portfolio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/affine_transform.html">affine_transform</a></span><span class="op">(</span><span class="va">returns</span>, A <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">portfolio</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.062</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">portfolio</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0336</span></span></code></pre></div>
<p>The portfolio return is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.6</mn><mo>√ó</mo><mn>0.05</mn><mo>+</mo><mn>0.4</mn><mo>√ó</mo><mn>0.08</mn><mo>=</mo><mn>0.062</mn></mrow><annotation encoding="application/x-tex">0.6 \times 0.05 + 0.4 \times 0.08 = 0.062</annotation></semantics></math>.
The portfolio variance is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>Œ£</mi><msup><mi>w</mi><mi>‚ä§</mi></msup></mrow><annotation encoding="application/x-tex">w \Sigma w^\top</annotation></semantics></math>,
a scalar that captures the diversification benefit.</p>
</div>
<div class="section level3">
<h3 id="dimensionality-reduction">Dimensionality reduction<a class="anchor" aria-label="anchor" href="#dimensionality-reduction"></a>
</h3>
<p>Affine transforms can also project to lower dimensions. For instance,
computing the sum and difference of two variables.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvn.html">mvn</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A maps (X1, X2) -&gt; (X1 + X2, X1 - X2)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>              <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/affine_transform.html">affine_transform</a></span><span class="op">(</span><span class="va">X</span>, A <span class="op">=</span> <span class="va">A</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10 -4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]   15   -5</span></span>
<span><span class="co">#&gt; [2,]   -5   11</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="mixture-distribution-basics">Mixture Distribution Basics<a class="anchor" aria-label="anchor" href="#mixture-distribution-basics"></a>
</h2>
<p>A mixture distribution is constructed from a list of component
distributions and a vector of non-negative weights that sum to one.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixture.html">mixture</a></span><span class="op">(</span></span>
<span>  components <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">m</span></span>
<span><span class="co">#&gt; Mixture distribution (2 components) </span></span>
<span><span class="co">#&gt;   [w=0.400] Normal distribution (mu = -2, var = 1)</span></span>
<span><span class="co">#&gt;   [w=0.600] Normal distribution (mu = 3, var = 0.5)</span></span></code></pre></div>
<div class="section level3">
<h3 id="mean-and-variance">Mean and variance<a class="anchor" aria-label="anchor" href="#mean-and-variance"></a>
</h3>
<p>The mixture mean is the weighted average of component means:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>X</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mo>‚àë</mo><mi>k</mi></msub><msub><mi>w</mi><mi>k</mi></msub><msub><mi>Œº</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">E[X] = \sum_k w_k \mu_k</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>The mixture variance uses the law of total variance:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><munder><mrow><msub><mo>‚àë</mo><mi>k</mi></msub><msub><mi>w</mi><mi>k</mi></msub><msubsup><mi>œÉ</mi><mi>k</mi><mn>2</mn></msubsup></mrow><mo accent="true">‚èü</mo></munder><mtext mathvariant="normal">within-component</mtext></munder><mo>+</mo><munder><munder><mrow><msub><mo>‚àë</mo><mi>k</mi></msub><msub><mi>w</mi><mi>k</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>k</mi></msub><mo>‚àí</mo><mover><mi>Œº</mi><mo accent="true">‚Äæ</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><mo accent="true">‚èü</mo></munder><mtext mathvariant="normal">between-component</mtext></munder></mrow><annotation encoding="application/x-tex">\text{Var}(X) = \underbrace{\sum_k w_k \sigma_k^2}_{\text{within-component}} + \underbrace{\sum_k w_k(\mu_k - \bar\mu)^2}_{\text{between-component}}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6.7</span></span></code></pre></div>
<p>The between-component term captures the spread of the component means
around the overall mean. This is why mixtures can have much larger
variance than any individual component.</p>
</div>
<div class="section level3">
<h3 id="density-and-cdf">Density and CDF<a class="anchor" aria-label="anchor" href="#density-and-cdf"></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density()</a></code> and <code><a href="../reference/cdf.html">cdf()</a></code> return callable
functions, following the same pattern as other distributions in the
package.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">8</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">y_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="va">f</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="va">y_vals</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Bimodal mixture density"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"f(x)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multivariate_files/figure-html/mixture-density-1.png" class="r-plt" width="576"></p>
<p>The bimodal shape is clearly visible, with peaks near
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àí</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">-2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn><annotation encoding="application/x-tex">3</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="va">F_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="va">F_vals</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Mixture CDF"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"F(x)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multivariate_files/figure-html/mixture-cdf-1.png" class="r-plt" width="576"></p>
</div>
<div class="section level3">
<h3 id="sampling-1">Sampling<a class="anchor" aria-label="anchor" href="#sampling-1"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu">s</span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">samples</span>, breaks <span class="op">=</span> <span class="fl">50</span>, probability <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Mixture samples with true density"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="va">y_vals</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="multivariate_files/figure-html/mixture-sampling-1.png" class="r-plt" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="mixture-operations">Mixture Operations<a class="anchor" aria-label="anchor" href="#mixture-operations"></a>
</h2>
<div class="section level3">
<h3 id="marginals-of-mixtures">Marginals of mixtures<a class="anchor" aria-label="anchor" href="#marginals-of-mixtures"></a>
</h3>
<p>The marginal of a mixture is a mixture of marginals with the same
weights. This follows directly from the definition:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>I</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>‚àë</mo><mi>k</mi></msub><msub><mi>w</mi><mi>k</mi></msub><mspace width="0.167em"></mspace><msub><mi>p</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>I</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(x_I) = \sum_k w_k\, p_k(x_I)</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixture.html">mixture</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/mvn.html">mvn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/mvn.html">mvn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m2_x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marginal.html">marginal</a></span><span class="op">(</span><span class="va">m2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">m2_x1</span></span>
<span><span class="co">#&gt; Mixture distribution (2 components) </span></span>
<span><span class="co">#&gt;   [w=0.500] Normal distribution (mu = 0, var = 1)</span></span>
<span><span class="co">#&gt;   [w=0.500] Normal distribution (mu = 3, var = 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">m2_x1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span></code></pre></div>
<p>The marginal mean is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn><mo>√ó</mo><mn>0</mn><mo>+</mo><mn>0.5</mn><mo>√ó</mo><mn>3</mn><mo>=</mo><mn>1.5</mn></mrow><annotation encoding="application/x-tex">0.5 \times 0 + 0.5 \times 3 = 1.5</annotation></semantics></math>,
the weighted average of the component marginal means.</p>
</div>
<div class="section level3">
<h3 id="conditional-of-mixtures-bayesian-weight-update">Conditional of mixtures (Bayesian weight update)<a class="anchor" aria-label="anchor" href="#conditional-of-mixtures-bayesian-weight-update"></a>
</h3>
<p>Conditioning a mixture on observed values updates the component
weights via Bayes‚Äô rule. Each component‚Äôs weight is scaled by its
marginal density at the observed value:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub><mi>‚Ä≤</mi><mo>‚àù</mo><msub><mi>w</mi><mi>k</mi></msub><mspace width="0.167em"></mspace><msub><mi>f</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mtext mathvariant="normal">obs</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w_k' \propto w_k \, f_k(x_{\text{obs}})</annotation></semantics></math></p>
<p>Components whose marginal density is higher at the observed value
receive more weight.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional.html">conditional</a></span><span class="op">(</span><span class="va">m2</span>, given_indices <span class="op">=</span> <span class="fl">2</span>, given_values <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">mc</span></span>
<span><span class="co">#&gt; Mixture distribution (2 components) </span></span>
<span><span class="co">#&gt;   [w=0.989] Normal distribution (mu = 0, var = 1)</span></span>
<span><span class="co">#&gt;   [w=0.011] Normal distribution (mu = 3, var = 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mc</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.03296083</span></span></code></pre></div>
<p>Conditioning on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X_2 = 0</annotation></semantics></math>
shifts weight toward the first component (whose mean for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>
is 0) and away from the second component (whose mean for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>
is 3). The conditional mean of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>
is therefore pulled closer to 0 than the unconditional value of 1.5.</p>
<p>We can also condition at a value near the second component to see the
opposite effect.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mc_high</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional.html">conditional</a></span><span class="op">(</span><span class="va">m2</span>, given_indices <span class="op">=</span> <span class="fl">2</span>, given_values <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">mc_high</span></span>
<span><span class="co">#&gt; Mixture distribution (2 components) </span></span>
<span><span class="co">#&gt;   [w=0.011] Normal distribution (mu = 0, var = 1)</span></span>
<span><span class="co">#&gt;   [w=0.989] Normal distribution (mu = 3, var = 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mc_high</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.967039</span></span></code></pre></div>
<p>Now the weight shifts toward the second component, and the
conditional mean of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>
is pulled toward 3.</p>
</div>
</div>
<div class="section level2">
<h2 id="practical-example-gaussian-mixture-classification">Practical Example: Gaussian Mixture Classification<a class="anchor" aria-label="anchor" href="#practical-example-gaussian-mixture-classification"></a>
</h2>
<p>Gaussian mixture models (GMMs) are widely used for soft
classification. The idea: each component represents a class, and
conditioning on observed features updates the class probabilities.</p>
<div class="section level3">
<h3 id="setup-a-two-class-gmm">Setup: a two-class GMM<a class="anchor" aria-label="anchor" href="#setup-a-two-class-gmm"></a>
</h3>
<p>Consider two clusters in 2D, representing two classes with equal
prior probability.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">class_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvn.html">mvn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.8</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">class_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvn.html">mvn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gmm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixture.html">mixture</a></span><span class="op">(</span></span>
<span>  components <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">class_a</span>, <span class="va">class_b</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">gmm</span></span>
<span><span class="co">#&gt; Mixture distribution (2 components) </span></span>
<span><span class="co">#&gt;   [w=0.500] Multivariate normal distribution (2 dimensions)</span></span>
<span><span class="co">#&gt;   [w=0.500] Multivariate normal distribution (2 dimensions)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualise-the-clusters">Visualise the clusters<a class="anchor" aria-label="anchor" href="#visualise-the-clusters"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">314</span><span class="op">)</span></span>
<span><span class="va">samp_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">class_a</span><span class="op">)</span><span class="op">(</span><span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">samp_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">class_b</span><span class="op">)</span><span class="op">(</span><span class="fl">300</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">samp_a</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">samp_a</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Two-class GMM samples"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">samp_b</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">samp_b</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"tomato"</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class A"</span>, <span class="st">"Class B"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"tomato"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="multivariate_files/figure-html/gmm-scatter-1.png" class="r-plt" width="576"></p>
</div>
<div class="section level3">
<h3 id="soft-classification-by-conditioning">Soft classification by conditioning<a class="anchor" aria-label="anchor" href="#soft-classification-by-conditioning"></a>
</h3>
<p>Suppose we observe
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">X_1 = -1</annotation></semantics></math>.
Conditioning updates the class weights based on how likely each
component is to produce that value.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_neg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional.html">conditional</a></span><span class="op">(</span><span class="va">gmm</span>, given_indices <span class="op">=</span> <span class="fl">1</span>, given_values <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">post_neg</span></span>
<span><span class="co">#&gt; Mixture distribution (2 components) </span></span>
<span><span class="co">#&gt;   [w=0.999] Normal distribution (mu = -0.7, var = 0.71)</span></span>
<span><span class="co">#&gt;   [w=0.001] Normal distribution (mu = 2.5, var = 1.13333)</span></span></code></pre></div>
<p>The updated weights give the posterior class probabilities. Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">X_1 = -1</annotation></semantics></math>
is much more likely under Class A (centred at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àí</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">-2</annotation></semantics></math>)
than Class B (centred at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>),
Class A receives most of the weight.</p>
<p>The conditional distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">X_1 = -1</annotation></semantics></math>
is itself a mixture of the two conditional normals.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">post_neg</span><span class="op">)</span></span>
<span><span class="va">x2_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">y_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x2_grid</span>, <span class="va">f_post</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x2_grid</span>, <span class="va">y_post</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="st">"|"</span> <span class="op">~</span> <span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Posterior density of X2 given X1 = -1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multivariate_files/figure-html/gmm-classify-neg-density-1.png" class="r-plt" width="576"></p>
<p>Now observe
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">X_1 = 2</annotation></semantics></math>,
which sits near the centre of Class B.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional.html">conditional</a></span><span class="op">(</span><span class="va">gmm</span>, given_indices <span class="op">=</span> <span class="fl">1</span>, given_values <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">post_pos</span></span>
<span><span class="co">#&gt; Mixture distribution (2 components) </span></span>
<span><span class="co">#&gt;   [w=0.000] Normal distribution (mu = 0.2, var = 0.71)</span></span>
<span><span class="co">#&gt;   [w=1.000] Normal distribution (mu = 1.5, var = 1.13333)</span></span></code></pre></div>
<p>As expected, the weight shifts heavily toward Class B. The
conditional density of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>
now concentrates around the Class B conditional mean.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_post_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">post_pos</span><span class="op">)</span></span>
<span><span class="va">y_post_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x2_grid</span>, <span class="va">f_post_pos</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x2_grid</span>, <span class="va">y_post_pos</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="st">"|"</span> <span class="op">~</span> <span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Posterior density of X2 given X1 = 2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multivariate_files/figure-html/gmm-classify-pos-density-1.png" class="r-plt" width="576"></p>
</div>
<div class="section level3">
<h3 id="ambiguous-observations">Ambiguous observations<a class="anchor" aria-label="anchor" href="#ambiguous-observations"></a>
</h3>
<p>When the observation falls between the two cluster means, both
classes retain meaningful probability and the posterior becomes
bimodal.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional.html">conditional</a></span><span class="op">(</span><span class="va">gmm</span>, given_indices <span class="op">=</span> <span class="fl">1</span>, given_values <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">post_mid</span></span>
<span><span class="co">#&gt; Mixture distribution (2 components) </span></span>
<span><span class="co">#&gt;   [w=0.746] Normal distribution (mu = -0.4, var = 0.71)</span></span>
<span><span class="co">#&gt;   [w=0.254] Normal distribution (mu = 2.16667, var = 1.13333)</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_post_mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">post_mid</span><span class="op">)</span></span>
<span><span class="va">y_post_mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x2_grid</span>, <span class="va">f_post_mid</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x2_grid</span>, <span class="va">y_post_mid</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="st">"|"</span> <span class="op">~</span> <span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Posterior density of X2 given X1 = 0 (ambiguous)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="multivariate_files/figure-html/gmm-classify-mid-density-1.png" class="r-plt" width="576"></p>
<p>At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X_1 = 0</annotation></semantics></math>
the posterior for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>
is bimodal ‚Äì one mode near the Class A conditional mean, one near Class
B. Although
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X_1 = 0</annotation></semantics></math>
is equidistant from the two class means
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àí</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">-2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>),
Class A receives roughly 75% of the posterior weight because its broader
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>
variance
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>œÉ</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma^2 = 1</annotation></semantics></math>
vs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.6</mn><annotation encoding="application/x-tex">0.6</annotation></semantics></math>)
gives it higher density at the midpoint. Class B still retains about 25%
of the weight, so neither class is overwhelmingly dominant. This is the
hallmark of soft classification: rather than forcing a hard decision,
the mixture posterior represents genuine uncertainty about the class
label.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
