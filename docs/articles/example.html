<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>algebraic.dist: Examples • algebraic.dist</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="algebraic.dist: Examples">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">algebraic.dist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/algebra.html">Distribution Algebra with algebraic.dist</a>
    </li>
    <li>
      <a href="../articles/example.html">algebraic.dist: Examples</a>
    </li>
    <li>
      <a href="../articles/multivariate.html">Multivariate and Mixture Distributions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/queelius/algebraic.dist/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>algebraic.dist: Examples</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/algebraic.dist/blob/HEAD/vignettes/example.Rmd" class="external-link"><code>vignettes/example.Rmd</code></a></small>
      <div class="hidden name"><code>example.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>To demonstrate the R package <code>algebraic.dist</code>, we consider
the multivariate normal distribution (MVN) and its empirical
approximation.</p>
<p>We start by loading the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/algebraic.dist" class="external-link">algebraic.dist</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="defining-the-data-generating-process">Defining the data generating process<a class="anchor" aria-label="anchor" href="#defining-the-data-generating-process"></a>
</h2>
<p>We define the parameters of the data generating process (DGP)
with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we define the parameters of the MVN</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvn.html">mvn</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; Multivariate normal distribution (5 dimensions) </span></span>
<span><span class="co">#&gt;   mu:</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4 5</span></span>
<span><span class="co">#&gt;   sigma:</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    2    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    3    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    4    0</span></span>
<span><span class="co">#&gt; [5,]    0    0    0    0    5</span></span></code></pre></div>
<p>When we print out the parameters, we get a large vector that includes
both the elements of the mean vector
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>)
and the elements of the variance-covariance matrix
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Σ</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt;     mu1     mu2     mu3     mu4     mu5  sigma1  sigma2  sigma3  sigma4  sigma5 </span></span>
<span><span class="co">#&gt;       1       2       3       4       5       1       0       0       0       0 </span></span>
<span><span class="co">#&gt;  sigma6  sigma7  sigma8  sigma9 sigma10 sigma11 sigma12 sigma13 sigma14 sigma15 </span></span>
<span><span class="co">#&gt;       0       2       0       0       0       0       0       3       0       0 </span></span>
<span><span class="co">#&gt; sigma16 sigma17 sigma18 sigma19 sigma20 sigma21 sigma22 sigma23 sigma24 sigma25 </span></span>
<span><span class="co">#&gt;       0       0       0       4       0       0       0       0       0       5</span></span></code></pre></div>
<p>Each observation is an i.i.d. vector from the MVN. We sample from the
MVN with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we generate a sample of size n</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="co"># we sample from the MVN</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre></div>
<p>We have a sample of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>10000</mn></mrow><annotation encoding="application/x-tex">n=10000</annotation></semantics></math>
from the DGP. We show some observations from this sample with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span>, n<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1]   [,2]  [,3]  [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] -0.400  2.361 -1.22 3.989 6.39</span></span>
<span><span class="co">#&gt; [2,]  2.148 -0.576  2.57 3.512 4.37</span></span>
<span><span class="co">#&gt; [3,]  0.446  2.890  6.58 0.738 6.15</span></span>
<span><span class="co">#&gt; [4,] -0.863  1.262  2.91 5.086 2.96</span></span>
<span><span class="co">#&gt; [5,]  1.468  2.513  0.74 5.476 9.22</span></span>
<span><span class="co">#&gt; [6,]  0.903  0.677  2.97 2.346 1.62</span></span></code></pre></div>
<p>Now, we also construct a empirical distribution from the sample
with:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/empirical_dist.html">empirical_dist</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Empirical distribution (10000 observations, 5 dimensions)</span></span></code></pre></div>
<p>Since this is the empirical distribution, it is parameter-free:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>Let’s show the supports of the empirical distribution and the
MVN:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate a data frame with the dimension, supremum,</span></span>
<span><span class="co"># and infimum of the MVN and empirical distribution</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>supremum.mvn <span class="op">=</span> <span class="fu"><a href="../reference/supremum.html">supremum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 supremum.emp <span class="op">=</span> <span class="fu"><a href="../reference/supremum.html">supremum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 infimum.mvn <span class="op">=</span> <span class="fu"><a href="../reference/infimum.html">infimum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 infimum.emp <span class="op">=</span> <span class="fu"><a href="../reference/infimum.html">infimum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"param"</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;        supremum.mvn supremum.emp infimum.mvn infimum.emp</span></span>
<span><span class="co">#&gt; param1          Inf         4.58        -Inf       -2.82</span></span>
<span><span class="co">#&gt; param2          Inf         7.08        -Inf       -3.42</span></span>
<span><span class="co">#&gt; param3          Inf         9.21        -Inf       -3.01</span></span>
<span><span class="co">#&gt; param4          Inf        11.80        -Inf       -2.61</span></span>
<span><span class="co">#&gt; param5          Inf        13.49        -Inf       -4.88</span></span></code></pre></div>
<p>Let’s compare the mean and covariance-variance matrices of both the
MVN and the empirical distribution of the MVN. First, let’s look at the
means.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4 5</span></span>
<span><span class="co">#&gt; [1] 0.991 1.974 2.981 4.034 4.973</span></span></code></pre></div>
<p>As expected, pretty close. Now let’s look at the
variance-covariance:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    2    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    3    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    4    0</span></span>
<span><span class="co">#&gt; [5,]    0    0    0    0    5</span></span>
<span><span class="co">#&gt;         [,1]      [,2]      [,3]     [,4]    [,5]</span></span>
<span><span class="co">#&gt; [1,] 1.01490  0.006508  0.005468  0.00654  0.0384</span></span>
<span><span class="co">#&gt; [2,] 0.00651  1.984264 -0.000128  0.04647 -0.0432</span></span>
<span><span class="co">#&gt; [3,] 0.00547 -0.000128  2.956973 -0.01391  0.0135</span></span>
<span><span class="co">#&gt; [4,] 0.00654  0.046470 -0.013906  3.93482 -0.0848</span></span>
<span><span class="co">#&gt; [5,] 0.03844 -0.043164  0.013515 -0.08485  5.0086</span></span></code></pre></div>
<p>The true variances of the population defined by the MVN
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
is the diagonal of the variance-covariance matrix:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4 5</span></span>
<span><span class="co">#&gt; [1] 1.01 1.98 2.96 3.93 5.01</span></span></code></pre></div>
<p>Let’s compute the variances using the general expectation method:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu.emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">emp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">mu.emp</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.01 1.98 2.96 3.93 5.01</span></span>
<span><span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">M</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.01 1.96 3.01 3.94 5.07</span></span></code></pre></div>
<p>We see that these are pretty good estimates, as the expectation is
actually a Monte Carlo approximation. We can see the CI’s with:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">emp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">mu.emp</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>compute_stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 1.01 1.98 2.96 3.93 5.01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ci</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.987 1.04</span></span>
<span><span class="co">#&gt; [2,] 1.929 2.04</span></span>
<span><span class="co">#&gt; [3,] 2.875 3.04</span></span>
<span><span class="co">#&gt; [4,] 3.827 4.04</span></span>
<span><span class="co">#&gt; [5,] 4.871 5.15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] 10000</span></span>
<span><span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">M</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, compute_stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 1.01 2.02 3.10 3.89 5.09</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ci</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.983 1.04</span></span>
<span><span class="co">#&gt; [2,] 1.961 2.07</span></span>
<span><span class="co">#&gt; [3,] 3.017 3.19</span></span>
<span><span class="co">#&gt; [4,] 3.787 4.00</span></span>
<span><span class="co">#&gt; [5,] 4.942 5.23</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] 10000</span></span></code></pre></div>
<p>Next, we use the <code>rmap</code> function on the MVN and the
empirical distribution to compute the distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><annotation encoding="application/x-tex">(X - E(X))^2</annotation></semantics></math>.
If we take the mean of this, we should get the variance as shown
above:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu.emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmap.html">rmap</a></span><span class="op">(</span><span class="va">emp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">mu.emp</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.01 1.98 2.96 3.93 5.01</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmap.html">rmap</a></span><span class="op">(</span><span class="va">M</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.01 2.01 2.99 4.07 4.98</span></span></code></pre></div>
<p>These are both reasonable estimates of the variance.</p>
<p>The PDF of the empirical is not very useful – it gets
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">1/n</annotation></semantics></math>
for each observation:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"empirical(x)"</span>, <span class="st">"MVN(y)"</span><span class="op">)</span>,</span>
<span>  pdf.emp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  pdf.mvn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             ob pdf.emp    pdf.mvn</span></span>
<span><span class="co">#&gt; 1 empirical(x)  0.0001 0.00000258</span></span>
<span><span class="co">#&gt; 2       MVN(y)  0.0000 0.00038733</span></span></code></pre></div>
<p>Let’s plot the CDF of marginal distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X1.emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marginal.html">marginal</a></span><span class="op">(</span><span class="va">emp</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">F1.emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">X1.emp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu">F1.emp</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, from <span class="op">=</span> <span class="fu"><a href="../reference/infimum.html">infimum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">X1.emp</span><span class="op">)</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="../reference/supremum.html">supremum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">X1.emp</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marginal.html">marginal</a></span><span class="op">(</span><span class="va">M</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">F1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu">F1</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, from <span class="op">=</span> <span class="fu"><a href="../reference/infimum.html">infimum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">X1.emp</span><span class="op">)</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="../reference/supremum.html">supremum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">X1.emp</span><span class="op">)</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"empirical"</span>, <span class="st">"MVN"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_files/figure-html/marginal-test-1.png" class="r-plt" width="576"></p>
<p>Given the sample size, the empirical distribution’s CDF is
essentially the same as the MVN’s CDF (they’re right on top of each
other). Let’s zoom in much closer so we can ee that the empirical CDF is
a step function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu">F1.emp</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">1.0005</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_files/figure-html/marginal-test-zoom-1.png" class="r-plt" width="576"></p>
<p>Let’s compute some expectations of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"E(X1) = "</span>, <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">)</span>, <span class="st">"( expected "</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>, <span class="st">")\n"</span>,</span>
<span>    <span class="st">"Var(X1) = "</span>, <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>,</span>
<span>                              <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>                                  <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>,</span>
<span>                                                   <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">)</span></span>
<span>                                  <span class="op">)</span><span class="op">^</span><span class="fl">2</span> </span>
<span>                              <span class="op">}</span><span class="op">)</span>,</span>
<span>    <span class="st">"( expected "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>, <span class="st">")\n"</span>,</span>
<span>    <span class="st">"Skewness(X1) = "</span>, <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>,</span>
<span>                                   <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>                                       <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span> <span class="op">/</span> </span>
<span>                                       <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span> </span>
<span>                                   <span class="op">}</span><span class="op">)</span>,</span>
<span>    <span class="st">"( expected 0 )\n"</span>,</span>
<span>    <span class="st">"E(X^2) = "</span>, <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="st">"( expected "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="co">#&gt; E(X1) =  1 ( expected  1 )</span></span>
<span><span class="co">#&gt;  Var(X1) =  1 ( expected  1 )</span></span>
<span><span class="co">#&gt;  Skewness(X1) =  -0.000000000000341 ( expected 0 )</span></span>
<span><span class="co">#&gt;  E(X^2) =  2 ( expected  2 )</span></span></code></pre></div>
<p>Let’s show a scatter plot of the joint distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>4</mn></msub><annotation encoding="application/x-tex">X_4</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataX2X4.emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="fu"><a href="../reference/marginal.html">marginal</a></span><span class="op">(</span><span class="va">emp</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span></span>
<span><span class="va">dataX2X4.mvn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="fu"><a href="../reference/marginal.html">marginal</a></span><span class="op">(</span><span class="va">M</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># scatter plot a 2d sample. use xlab and ylab to label the axes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataX2X4.emp</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">dataX2X4.emp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"blue"</span>, xlab <span class="op">=</span> <span class="st">"X2"</span>, ylab <span class="op">=</span> <span class="st">"X4"</span><span class="op">)</span></span>
<span><span class="co"># overlay in green the MVN data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">dataX2X4.mvn</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">dataX2X4.mvn</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"empirical"</span>, <span class="st">"MVN"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"green"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Scatter plot of X2 and X4"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_files/figure-html/joint-marginal-test-1.png" class="r-plt" width="576"></p>
<p>Let’s look at the MVN’s multivariate CDF:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.000792</span></span></code></pre></div>
<p>Now we show the mean of the conditional distribution,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>X</mi><mn>2</mn></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X | X_1 + X_2 &lt; 0</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/conditional.html">conditional</a></span><span class="op">(</span><span class="va">emp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.256 -0.402  2.886  3.790  4.962</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/conditional.html">conditional</a></span><span class="op">(</span><span class="va">M</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.188 -0.502  2.941  3.939  5.060</span></span></code></pre></div>
<p>I didn’t do the analysis of what this distribution’s mean should
theoretically be, if it’s even practical to derive, but it doesn’t look
unreasonable. We see that the mean of the first two components are
negative, which makes sense: the sum of the first two components is
negative, so the mean of the first two components should be
negative.</p>
</div>
<div class="section level2">
<h2 id="working-with-edist-objects">Working with <code>edist</code> Objects<a class="anchor" aria-label="anchor" href="#working-with-edist-objects"></a>
</h2>
<p>The <code>edist</code> object is a key component of the
<code>algebraic.dist</code> package. It represents a distribution that
is an algebraic expression of other distributions.</p>
<div class="section level3">
<h3 id="creating-edist-objects">Creating <code>edist</code> Objects<a class="anchor" aria-label="anchor" href="#creating-edist-objects"></a>
</h3>
<p>You can create an <code>edist</code> object using the
<code>edist</code> function. Here’s an example:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edist.html">edist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">0</span>, var <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                <span class="st">"y"</span> <span class="op">=</span> <span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This creates an <code>edist</code> object representing the
distribution of the sum of a normal random variable and an exponential
random variable.</p>
</div>
<div class="section level3">
<h3 id="printing-edist-objects">Printing <code>edist</code> Objects<a class="anchor" aria-label="anchor" href="#printing-edist-objects"></a>
</h3>
<p>You can print an <code>edist</code> object to see its expression and
the distributions of its variables:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; Expression distribution: expression(x + y) </span></span>
<span><span class="co">#&gt;    x  ~  Normal distribution (mu = 0, var = 1) </span></span>
<span><span class="co">#&gt;    y  ~  Exponential distribution (rate = 1)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mean-and-variance-of-edist-objects">Mean and Variance of <code>edist</code> Objects<a class="anchor" aria-label="anchor" href="#mean-and-variance-of-edist-objects"></a>
</h3>
<p>You can compute the mean and variance of an <code>edist</code> object
using the <code>mean</code> and <code>vcov</code> functions:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.996</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.97</span></span></code></pre></div>
<p>Let’s have a look at the parameters of the <code>edist</code>
object:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt;   x.mu  x.var y.rate </span></span>
<span><span class="co">#&gt;      0      1      1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sampling-from-edist-objects">Sampling from <code>edist</code> Objects<a class="anchor" aria-label="anchor" href="#sampling-from-edist-objects"></a>
</h3>
<p>You can generate a sample from an edist object using the sampler
method:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu">s</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>  <span class="co"># Generate a sample of size 10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1]  3.2954  1.1684  4.3740  4.2106  0.0794  1.1944  3.0863  1.1661  0.7995</span></span>
<span><span class="co">#&gt; [10] -1.1392</span></span></code></pre></div>
<p>This concludes our overview of the <code>edist</code> object. It’s a
powerful tool for working with algebraic expressions of distributions,
and we hope you find it useful in your statistical analyses.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
