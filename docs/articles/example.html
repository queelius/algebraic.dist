<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>algebraic.dist: Examples • algebraic.dist</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="algebraic.dist: Examples">
<meta property="og:description" content="algebraic.dist">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">algebraic.dist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example.html">algebraic.dist: Examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/queelius/algebraic.dist/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="example_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>algebraic.dist: Examples</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/algebraic.dist/blob/HEAD/vignettes/example.Rmd" class="external-link"><code>vignettes/example.Rmd</code></a></small>
      <div class="hidden name"><code>example.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>To demonstrate the R package <code>algebraic.dist</code>, we consider the multivariate normal distribution (MVN) and its empirical approximation.</p>
<p>We start by loading the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/algebraic.dist" class="external-link">algebraic.dist</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="defining-the-data-generating-process">Defining the data generating process<a class="anchor" aria-label="anchor" href="#defining-the-data-generating-process"></a>
</h2>
<p>We define the parameters of the data generating process (DGP) with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we define the parameters of the MVN</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvn.html">mvn</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; Multivariate normal distribution with mean:</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4 5</span></span>
<span><span class="co">#&gt; and variance-covariance matrix:</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    2    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    3    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    4    0</span></span>
<span><span class="co">#&gt; [5,]    0    0    0    0    5</span></span></code></pre></div>
<p>Each observation is an i.i.d. vector from the MVN. We sample from the MVN with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we generate a sample of size n</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100000</span></span>
<span></span>
<span><span class="co"># we sample from the MVN</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre></div>
<p>We have a sample of size <span class="math inline">\(n=100000\)</span> from the DGP. We show some observations from this sample with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span>, n<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] -0.379 3.34 4.66 3.53 2.03</span></span>
<span><span class="co">#&gt; [2,] -1.244 1.72 1.78 5.94 3.10</span></span>
<span><span class="co">#&gt; [3,]  1.416 4.76 1.97 2.19 7.57</span></span>
<span><span class="co">#&gt; [4,]  0.782 3.62 2.28 5.15 3.54</span></span>
<span><span class="co">#&gt; [5,]  0.972 2.41 2.19 3.54 1.30</span></span>
<span><span class="co">#&gt; [6,]  1.460 1.46 4.06 5.47 5.20</span></span></code></pre></div>
<p>Now, we also construct a empirical distribution from the sample with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/empirical_dist.html">empirical_dist</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Empirical Distribution </span></span>
<span><span class="co">#&gt; Mean:</span></span>
<span><span class="co">#&gt; [1] 1.00 2.00 3.00 4.01 4.99</span></span>
<span><span class="co">#&gt; Covariance:</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]     [,4]     [,5]</span></span>
<span><span class="co">#&gt; [1,]  0.994590 -0.000318  0.000127 -0.00888  0.00530</span></span>
<span><span class="co">#&gt; [2,] -0.000318  1.992270  0.006073 -0.01008 -0.00917</span></span>
<span><span class="co">#&gt; [3,]  0.000127  0.006073  2.991805  0.00015 -0.01201</span></span>
<span><span class="co">#&gt; [4,] -0.008884 -0.010080  0.000150  3.99985 -0.00469</span></span>
<span><span class="co">#&gt; [5,]  0.005302 -0.009167 -0.012007 -0.00469  4.98894</span></span>
<span><span class="co">#&gt; Number of observations: 100000</span></span></code></pre></div>
<p>Let’s show the supports of the empirical distribution and the MVN:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate a data frame with the dimension, supremum,</span></span>
<span><span class="co"># and infimum of the MVN and empirical distribution</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>supremum.mvn <span class="op">=</span> <span class="fu"><a href="../reference/supremum.html">supremum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 supremum.emp <span class="op">=</span> <span class="fu"><a href="../reference/supremum.html">supremum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 infimum.mvn <span class="op">=</span> <span class="fu"><a href="../reference/infimum.html">infimum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 infimum.emp <span class="op">=</span> <span class="fu"><a href="../reference/infimum.html">infimum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"param"</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;        supremum.mvn supremum.emp infimum.mvn infimum.emp</span></span>
<span><span class="co">#&gt; param1          Inf         5.24        -Inf       -3.24</span></span>
<span><span class="co">#&gt; param2          Inf         7.97        -Inf       -3.91</span></span>
<span><span class="co">#&gt; param3          Inf        10.40        -Inf       -4.81</span></span>
<span><span class="co">#&gt; param4          Inf        12.12        -Inf       -4.00</span></span>
<span><span class="co">#&gt; param5          Inf        14.41        -Inf       -4.56</span></span></code></pre></div>
<p>Let’s compare the mean and covariance-variance matrices of both the MVN and the empirical distribution of the MVN. First, let’s look at the means.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.00 2.00 3.00 4.01 4.99</span></span></code></pre></div>
<p>As expected, pretty close. Now let’s look at the variance-covariance:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    2    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    3    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    4    0</span></span>
<span><span class="co">#&gt; [5,]    0    0    0    0    5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]     [,4]     [,5]</span></span>
<span><span class="co">#&gt; [1,]  0.994590 -0.000318  0.000127 -0.00888  0.00530</span></span>
<span><span class="co">#&gt; [2,] -0.000318  1.992270  0.006073 -0.01008 -0.00917</span></span>
<span><span class="co">#&gt; [3,]  0.000127  0.006073  2.991805  0.00015 -0.01201</span></span>
<span><span class="co">#&gt; [4,] -0.008884 -0.010080  0.000150  3.99985 -0.00469</span></span>
<span><span class="co">#&gt; [5,]  0.005302 -0.009167 -0.012007 -0.00469  4.98894</span></span></code></pre></div>
<p>The true variances of the population defined by the MVN <span class="math inline">\(M\)</span> is the diagonal of the variance-covariance matrix:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4 5</span></span></code></pre></div>
<p>Let’s compute the variances using the general expectation method:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu.emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">emp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">mu.emp</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.995 1.992 2.992 4.000 4.989</span></span>
<span><span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">M</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.00 2.00 3.00 4.00 5.02</span></span></code></pre></div>
<p>We see that these are pretty good estimates, as the expectation is actually a Monte Carlo approximation. We can see the CI’s with:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">emp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">mu.emp</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>compute_stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 0.995 1.992 2.992 4.000 4.989</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ci</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.986 1.00</span></span>
<span><span class="co">#&gt; [2,] 1.975 2.01</span></span>
<span><span class="co">#&gt; [3,] 2.966 3.02</span></span>
<span><span class="co">#&gt; [4,] 3.965 4.03</span></span>
<span><span class="co">#&gt; [5,] 4.945 5.03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] 100000</span></span>
<span><span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">M</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, compute_stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 0.995 1.986 3.015 4.000 4.973</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ci</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.987 1.00</span></span>
<span><span class="co">#&gt; [2,] 1.969 2.00</span></span>
<span><span class="co">#&gt; [3,] 2.989 3.04</span></span>
<span><span class="co">#&gt; [4,] 3.965 4.03</span></span>
<span><span class="co">#&gt; [5,] 4.929 5.02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] 100000</span></span></code></pre></div>
<p>Next, we use the <code>rmap</code> function on the MVN and the empirical distribution to compute the distribution of <span class="math inline">\((X - E(X))^2\)</span>. If we take the mean of this, we should get the variance as shown above:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu.emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmap.html">rmap</a></span><span class="op">(</span><span class="va">emp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">mu.emp</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.995 1.992 2.992 4.000 4.989</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmap.html">rmap</a></span><span class="op">(</span><span class="va">M</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.993 2.007 3.012 3.968 5.010</span></span></code></pre></div>
<p>These are both reasonable estimates of the variance.</p>
<p>The PDF of the empirical is not very useful – it gets <span class="math inline">\(1/n\)</span> for each observation:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"empirical(x)"</span>, <span class="st">"MVN(y)"</span><span class="op">)</span>,</span>
<span>  pdf.emp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  pdf.mvn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             ob pdf.emp   pdf.mvn</span></span>
<span><span class="co">#&gt; 1 empirical(x) 0.00001 0.0000748</span></span>
<span><span class="co">#&gt; 2       MVN(y) 0.00000 0.0000307</span></span></code></pre></div>
<p>Let’s plot the CDF of marginal distribution of <span class="math inline">\(X_1\)</span>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X1.emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marginal.html">marginal</a></span><span class="op">(</span><span class="va">emp</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">F1.emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">X1.emp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu">F1.emp</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, from <span class="op">=</span> <span class="fu"><a href="../reference/infimum.html">infimum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">X1.emp</span><span class="op">)</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="../reference/supremum.html">supremum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">X1.emp</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/marginal.html">marginal</a></span><span class="op">(</span><span class="va">M</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">F1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu">F1</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, from <span class="op">=</span> <span class="fu"><a href="../reference/infimum.html">infimum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">X1.emp</span><span class="op">)</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="../reference/supremum.html">supremum</a></span><span class="op">(</span><span class="fu"><a href="../reference/sup.html">sup</a></span><span class="op">(</span><span class="va">X1.emp</span><span class="op">)</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"empirical"</span>, <span class="st">"MVN"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_files/figure-html/marginal-test-1.png" width="576"></p>
<p>Given the sample size, the empirical distribution’s CDF is essentially the same as the MVN’s CDF (they’re right on top of each other). Let’s zoom in much closer so we can ee that the empirical CDF is a step function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu">F1.emp</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">1.0005</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_files/figure-html/marginal-test-zoom-1.png" width="576"></p>
<p>Let’s compute some expectations of <span class="math inline">\(X_1\)</span>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"E(X1) = "</span>, <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">)</span>, <span class="st">"( expected "</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>, <span class="st">")\n"</span>,</span>
<span><span class="st">"Var(X1) = "</span>, <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"( expected "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>, <span class="st">")\n"</span>,</span>
<span><span class="st">"Skewness(X1) = "</span>, <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span>, <span class="st">"( expected 0 )\n"</span>,</span>
<span><span class="st">"E(X^2) = "</span>, <span class="fu"><a href="../reference/expectation.html">expectation</a></span><span class="op">(</span><span class="va">X1</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"( expected "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="co">#&gt; E(X1) =  1 ( expected  1 )</span></span>
<span><span class="co">#&gt;  Var(X1) =  1 ( expected  1 )</span></span>
<span><span class="co">#&gt;  Skewness(X1) =  -0.000000000000341 ( expected 0 )</span></span>
<span><span class="co">#&gt;  E(X^2) =  2 ( expected  2 )</span></span></code></pre></div>
<p>Let’s show a scatter plot of the joint distribution of <span class="math inline">\(X_2\)</span> and <span class="math inline">\(X_4\)</span>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataX2X4.emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="fu"><a href="../reference/marginal.html">marginal</a></span><span class="op">(</span><span class="va">emp</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span></span>
<span><span class="va">dataX2X4.mvn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="fu"><a href="../reference/marginal.html">marginal</a></span><span class="op">(</span><span class="va">M</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># scatter plot a 2d sample. use xlab and ylab to label the axes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dataX2X4.emp</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">dataX2X4.emp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"blue"</span>, xlab <span class="op">=</span> <span class="st">"X2"</span>, ylab <span class="op">=</span> <span class="st">"X4"</span><span class="op">)</span></span>
<span><span class="co"># overlay in green the MVN data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">dataX2X4.mvn</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">dataX2X4.mvn</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"empirical"</span>, <span class="st">"MVN"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"green"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Scatter plot of X2 and X4"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_files/figure-html/joint-marginal-test-1.png" width="576"></p>
<p>Let’s look at the MVN’s multivariate CDF:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.000792</span></span></code></pre></div>
<p>Now we show the mean of the conditional distribution, <span class="math inline">\(X | X_1 + X_2 &lt; 0\)</span>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/conditional.html">conditional</a></span><span class="op">(</span><span class="va">emp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.235 -0.465  2.952  4.038  4.949</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/conditional.html">conditional</a></span><span class="op">(</span><span class="va">M</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.205 -0.484  2.955  4.217  4.980</span></span></code></pre></div>
<p>I didn’t do the analysis of what this distribution’s mean should theoretically be, if it’s even practical to derive, but it doesn’t look unreasonable. We see that the mean of the first two components are negative, which makes sense: the sum of the first two components is negative, so the mean of the first two components should be negative.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
