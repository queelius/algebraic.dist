<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Distribution Algebra with algebraic.dist • algebraic.dist</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Distribution Algebra with algebraic.dist">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">algebraic.dist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/algebra.html">Distribution Algebra with algebraic.dist</a>
    </li>
    <li>
      <a href="../articles/example.html">algebraic.dist: Examples</a>
    </li>
    <li>
      <a href="../articles/multivariate.html">Multivariate and Mixture Distributions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/queelius/algebraic.dist/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Distribution Algebra with algebraic.dist</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/algebraic.dist/blob/HEAD/vignettes/algebra.Rmd" class="external-link"><code>vignettes/algebra.Rmd</code></a></small>
      <div class="hidden name"><code>algebra.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/algebraic.dist" class="external-link">algebraic.dist</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>algebraic.dist</code> package provides an <strong>algebra
over probability distributions</strong>. You can combine distribution
objects with standard arithmetic operators (<code>+</code>,
<code>-</code>, <code>*</code>, <code>/</code>, <code>^</code>) and
mathematical functions (<code>exp</code>, <code>log</code>,
<code>sqrt</code>, …), and the package will either
<strong>simplify</strong> the result to a known closed-form distribution
or fall back to <strong>Monte Carlo</strong> sampling when no closed
form exists.</p>
<p>This means you can write expressions like
<code>normal(0, 1) + normal(2, 3)</code> and get back a
<code>normal</code> object, without manually deriving the result. When
the package cannot simplify, the result is an <code>edist</code>
(expression distribution) that supports all the usual methods –
<code>mean</code>, <code>vcov</code>, <code>sampler</code>,
<code>cdf</code>, and more – via MC approximation.</p>
</div>
<div class="section level2">
<h2 id="basic-arithmetic">Basic Arithmetic<a class="anchor" aria-label="anchor" href="#basic-arithmetic"></a>
</h2>
<p>Arithmetic operators on <code>dist</code> objects create
<code>edist</code> (expression distribution) objects, which are then
automatically simplified when a closed-form rule applies. When no rule
matches, the <code>edist</code> is kept as-is.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span></code></pre></div>
<p>Since the sum of a normal and an exponential has no simple closed
form, <code>z</code> remains an <code>edist</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is_edist.html">is_edist</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "+_normal_exponential" "x_normal_exponential" "y_normal_exponential"</span></span>
<span><span class="co">#&gt; [4] "edist"                "dist"</span></span></code></pre></div>
<p>The <code>edist</code> still supports all distribution methods.
Moments are computed via Monte Carlo:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9944453</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.023444</span></span></code></pre></div>
<p>The theoretical mean is <code>0 + 1 = 1</code> and variance is
<code>1 + 1 = 2</code>, so the MC estimates should be close.</p>
</div>
<div class="section level2">
<h2 id="automatic-simplification">Automatic Simplification<a class="anchor" aria-label="anchor" href="#automatic-simplification"></a>
</h2>
<p>The real power of the package is <strong>automatic
simplification</strong>. When you compose distributions using operations
that have known closed-form results, the package returns the simplified
distribution directly – no sampling needed.</p>
<div class="section level3">
<h3 id="normal-algebra">Normal algebra<a class="anchor" aria-label="anchor" href="#normal-algebra"></a>
</h3>
<p>The sum and difference of independent normals is normal. Scalar
multiplication and location shifts are also handled.</p>
<p><strong>Sum of normals:</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_normal.html">is_normal</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 3, var = 9)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9</span></span></code></pre></div>
<p>The result is Normal(mu = 3, var = 9), since means add and variances
add for independent normals.</p>
<p><strong>Difference of normals:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Normal distribution (mu = -1, var = 9)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9</span></span></code></pre></div>
<p>Normal(mu = -1, var = 9) – means subtract, but variances still
add.</p>
<p><strong>Scalar multiplication:</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 6, var = 9)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9</span></span></code></pre></div>
<p>If <code>X ~ Normal(mu, v)</code>, then
<code>c * X ~ Normal(c * mu, c^2 * v)</code>.</p>
<p><strong>Location shift:</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 15, var = 2)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 15</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>Adding a constant shifts the mean but preserves the variance.</p>
</div>
<div class="section level3">
<h3 id="exponential-and-gamma-algebra">Exponential and Gamma algebra<a class="anchor" aria-label="anchor" href="#exponential-and-gamma-algebra"></a>
</h3>
<p>Sums of independent exponentials (with the same rate) produce gamma
distributions. Gamma distributions with the same rate also combine.</p>
<p><strong>Sum of exponentials:</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_gamma_dist.html">is_gamma_dist</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Gamma distribution (shape = 2, rate = 2)</span></span>
<span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; shape  rate </span></span>
<span><span class="co">#&gt;     2     2</span></span></code></pre></div>
<p>Two independent Exp(2) variables sum to Gamma(shape = 2, rate =
2).</p>
<p><strong>Gamma plus exponential:</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gamma_dist.html">gamma_dist</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Gamma distribution (shape = 4, rate = 2)</span></span>
<span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; shape  rate </span></span>
<span><span class="co">#&gt;     4     2</span></span></code></pre></div>
<p>Gamma(3, 2) + Exp(2) = Gamma(4, 2).</p>
<p><strong>Sum of gammas (same rate):</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gamma_dist.html">gamma_dist</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/gamma_dist.html">gamma_dist</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Gamma distribution (shape = 7, rate = 2)</span></span>
<span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; shape  rate </span></span>
<span><span class="co">#&gt;     7     2</span></span></code></pre></div>
<p>Gamma(3, 2) + Gamma(4, 2) = Gamma(7, 2) – shapes add when rates
match.</p>
</div>
<div class="section level3">
<h3 id="transform-rules">Transform rules<a class="anchor" aria-label="anchor" href="#transform-rules"></a>
</h3>
<p>Certain mathematical transformations of distributions have known
closed-form results.</p>
<p><strong>Exponential of a normal is log-normal:</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_lognormal.html">is_lognormal</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Log-normal distribution (meanlog = 0, sdlog = 1)</span></span></code></pre></div>
<p><strong>Logarithm of a log-normal is normal:</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="../reference/lognormal.html">lognormal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_normal.html">is_normal</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 0, var = 1)</span></span></code></pre></div>
<p><strong>Standard normal squared is chi-squared:</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="fu"><a href="../reference/is_chi_squared.html">is_chi_squared</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Chi-squared distribution (df = 1)</span></span></code></pre></div>
<p>This rule specifically applies when the normal has mean 0 and
variance 1.</p>
</div>
<div class="section level3">
<h3 id="other-simplification-rules">Other simplification rules<a class="anchor" aria-label="anchor" href="#other-simplification-rules"></a>
</h3>
<p><strong>Chi-squared addition:</strong></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chi_squared.html">chi_squared</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/chi_squared.html">chi_squared</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_chi_squared.html">is_chi_squared</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Chi-squared distribution (df = 8)</span></span>
<span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; df </span></span>
<span><span class="co">#&gt;  8</span></span></code></pre></div>
<p>Degrees of freedom add: Chi-squared(3) + Chi-squared(5) =
Chi-squared(8).</p>
<p><strong>Poisson addition:</strong></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/poisson_dist.html">poisson_dist</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/poisson_dist.html">poisson_dist</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_poisson_dist.html">is_poisson_dist</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Poisson distribution (lambda = 5)</span></span>
<span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; lambda </span></span>
<span><span class="co">#&gt;      5</span></span></code></pre></div>
<p>Rates add: Poisson(2) + Poisson(3) = Poisson(5).</p>
<p><strong>Product of log-normals:</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lognormal.html">lognormal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/lognormal.html">lognormal</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_lognormal.html">is_lognormal</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Log-normal distribution (meanlog = 1, sdlog = 2.23607)</span></span>
<span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt;  meanlog    sdlog </span></span>
<span><span class="co">#&gt; 1.000000 2.236068</span></span></code></pre></div>
<p>The product of independent log-normals is log-normal because
<code>log(X * Y) = log(X) + log(Y)</code>, and the sum of independent
normals is normal. So the <code>meanlog</code> values add and the
<code>sdlog</code> values combine as
<code>sqrt(sdlog1^2 + sdlog2^2)</code>.</p>
<p><strong>Uniform scaling and shifting:</strong></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="../reference/uniform_dist.html">uniform_dist</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_uniform_dist.html">is_uniform_dist</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Uniform distribution (min = 0, max = 2)</span></span>
<span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; min max </span></span>
<span><span class="co">#&gt;   0   2</span></span></code></pre></div>
<p>Scaling a Uniform(0, 1) by 2 gives Uniform(0, 2).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/uniform_dist.html">uniform_dist</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">5</span></span>
<span><span class="fu"><a href="../reference/is_uniform_dist.html">is_uniform_dist</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Uniform distribution (min = 5, max = 6)</span></span>
<span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; min max </span></span>
<span><span class="co">#&gt;   5   6</span></span></code></pre></div>
<p>Shifting Uniform(0, 1) by 5 gives Uniform(5, 6).</p>
</div>
</div>
<div class="section level2">
<h2 id="when-simplification-cannot-help">When Simplification Cannot Help<a class="anchor" aria-label="anchor" href="#when-simplification-cannot-help"></a>
</h2>
<p>When no algebraic rule matches, the result remains an unsimplified
<code>edist</code>. All distribution methods still work – they just use
Monte Carlo under the hood.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_edist.html">is_edist</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.02069384</span></span></code></pre></div>
<p>The true mean of <code>X * Y</code> where
<code>X ~ Normal(0, 1)</code> and <code>Y ~ Exp(1)</code> is
<code>E[X] * E[Y] = 0 * 1 = 0</code> (by independence), so the MC
estimate should be near zero.</p>
</div>
<div class="section level2">
<h2 id="realization-and-mc-fallback">Realization and MC Fallback<a class="anchor" aria-label="anchor" href="#realization-and-mc-fallback"></a>
</h2>
<p>You can explicitly convert any distribution to an empirical
distribution via <code><a href="../reference/realize.html">realize()</a></code>. This draws <code>n</code>
samples and wraps them in an <code>empirical_dist</code> that supports
exact (discrete) methods for CDF, density, conditional, and more.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">rd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/realize.html">realize</a></span><span class="op">(</span><span class="va">z</span>, n <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="va">rd</span></span>
<span><span class="co">#&gt; Realized distribution (10000 samples from: Expression distribution: x * y) </span></span>
<span><span class="co">#&gt;   source:</span></span>
<span><span class="co">#&gt; Expression distribution: x * y </span></span>
<span><span class="co">#&gt;    x  ~  Normal distribution (mu = 0, var = 1) </span></span>
<span><span class="co">#&gt;    y  ~  Exponential distribution (rate = 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rd</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.003321398</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">rd</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1]</span></span>
<span><span class="co">#&gt; [1,] 2.048537</span></span></code></pre></div>
<p>For <code>edist</code> objects, methods like <code><a href="../reference/cdf.html">cdf()</a></code>,
<code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density()</a></code>, and <code><a href="../reference/inv_cdf.html">inv_cdf()</a></code> automatically
materialize samples behind the scenes (with caching, so repeated calls
share the same sample). You do not need to call <code><a href="../reference/realize.html">realize()</a></code>
manually for these:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Fz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdf.html">cdf</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="fu">Fz</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.537</span></span>
<span><span class="fu">Fz</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7914</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="min-max-and-summary-operations">Min, Max, and Summary Operations<a class="anchor" aria-label="anchor" href="#min-max-and-summary-operations"></a>
</h2>
<p>The <code>Summary</code> group generic is implemented for
distributions. The <code><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum()</a></code> and <code><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod()</a></code> generics
reduce via <code>+</code> and <code>*</code>, so they benefit from all
the simplification rules. The <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min()</a></code> and <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max()</a></code>
generics create elementwise <code>edist</code> expressions.</p>
<p><strong>Min of exponentials</strong> has a special rule – the minimum
of independent exponentials is exponential with the sum of rates:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_exponential.html">is_exponential</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Exponential distribution (rate = 3)</span></span>
<span><span class="fu"><a href="../reference/params.html">params</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; rate </span></span>
<span><span class="co">#&gt;    3</span></span></code></pre></div>
<p>This is the well-known result: if <code>X ~ Exp(r1)</code> and
<code>Y ~ Exp(r2)</code>, then
<code>min(X, Y) ~ Exp(r1 + r2)</code>.</p>
<p><strong>Sum reduces via the <code>+</code> operator</strong>, so
simplification rules apply:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="../reference/normal.html">normal</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_normal.html">is_normal</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 1, var = 6)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<p>Three normals sum to a single normal: mean = 0 + 2 - 1 = 1, var = 1 +
3 + 2 = 6.</p>
<p><strong>Max and other combinations</strong> that lack closed forms
remain as <code>edist</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_edist.html">is_edist</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.170383</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="limiting-distributions">Limiting Distributions<a class="anchor" aria-label="anchor" href="#limiting-distributions"></a>
</h2>
<p>The package provides functions for common asymptotic results from
probability theory.</p>
<div class="section level3">
<h3 id="central-limit-theorem">Central Limit Theorem<a class="anchor" aria-label="anchor" href="#central-limit-theorem"></a>
</h3>
<p><code>clt(base_dist)</code> returns the limiting distribution of the
standardized sample mean, <code>sqrt(n) * (Xbar_n - mu)</code>. For a
univariate distribution with variance <code>sigma^2</code>, this is
<code>Normal(0, sigma^2)</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clt.html">clt</a></span><span class="op">(</span><span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 0, var = 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>For Exp(1), the mean is 1 and the variance is 1, so the CLT limit is
Normal(0, 1).</p>
</div>
<div class="section level3">
<h3 id="law-of-large-numbers">Law of Large Numbers<a class="anchor" aria-label="anchor" href="#law-of-large-numbers"></a>
</h3>
<p><code>lln(base_dist)</code> returns the degenerate distribution at
the population mean – the limit of <code>Xbar_n</code> as
<code>n -&gt; infinity</code>. It is represented as a normal with zero
variance.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lln.html">lln</a></span><span class="op">(</span><span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 1, var = 0)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="delta-method">Delta Method<a class="anchor" aria-label="anchor" href="#delta-method"></a>
</h3>
<p><code>delta_clt(base_dist, g, dg)</code> returns the limiting
distribution of <code>sqrt(n) * (g(Xbar_n) - g(mu))</code> under the
delta method. You supply the function <code>g</code> and its derivative
<code>dg</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/delta_clt.html">delta_clt</a></span><span class="op">(</span><span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, g <span class="op">=</span> <span class="va">exp</span>, dg <span class="op">=</span> <span class="va">exp</span><span class="op">)</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 0, var = 7.38906)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.389056</span></span></code></pre></div>
<p>For <code>g = exp</code> applied to Exp(1) (mean = 1, var = 1), the
delta method gives
<code>Normal(0, (exp(1))^2 * 1) = Normal(0, e^2)</code>.</p>
</div>
<div class="section level3">
<h3 id="moment-matching-normal-approximation">Moment-Matching Normal Approximation<a class="anchor" aria-label="anchor" href="#moment-matching-normal-approximation"></a>
</h3>
<p><code>normal_approx(x)</code> constructs a normal distribution that
matches the mean and variance of any input distribution:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gamma_dist.html">gamma_dist</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normal_approx.html">normal_approx</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="va">n</span></span>
<span><span class="co">#&gt; Normal distribution (mu = 2.5, var = 1.25)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.25</span></span></code></pre></div>
<p>The Gamma(5, 2) has mean 2.5 and variance 1.25, so the normal
approximation is Normal(2.5, 1.25).</p>
</div>
<div class="section level3">
<h3 id="empirical-clt-convergence">Empirical CLT Convergence<a class="anchor" aria-label="anchor" href="#empirical-clt-convergence"></a>
</h3>
<p>To see the CLT in action, we can draw replicated standardized sample
means at increasing sample sizes and watch them converge to the
predicted distribution:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">base</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exponential.html">exponential</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="va">ns</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">samp_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">5000</span>, <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampler.html">sampler</a></span><span class="op">(</span><span class="va">base</span><span class="op">)</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">base</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"n=%4d: mean=%.3f, var=%.3f\n"</span>,</span>
<span>              <span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">samp_means</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">samp_means</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; n=  10: mean=-0.006, var=1.002</span></span>
<span><span class="co">#&gt; n= 100: mean=-0.003, var=1.022</span></span>
<span><span class="co">#&gt; n=1000: mean=0.007, var=0.995</span></span></code></pre></div>
<p>Compare with the CLT prediction:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clt.html">clt</a></span><span class="op">(</span><span class="va">base</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"CLT:    mean=%.3f, var=%.3f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; CLT:    mean=0.000, var=1.000</span></span></code></pre></div>
<p>As <code>n</code> grows, the empirical mean converges to 0 and the
empirical variance converges to 1, matching the CLT limit of Normal(0,
1).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
