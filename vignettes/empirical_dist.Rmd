---
title: "Empirical distribution"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Empirical distribution}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction
To demonstrate the R package `algebraic.dst`, we consider the relatively
simple case of an observed sample of, we assume, i.i.d. random variables
$X_1,\ldots,X_n$ with unknown distribution $F$.

We will use the R package `algebraic.dist` to estimate the distribution $F$.

```{r setup}
library(algebraic.dist)
```

# Generating a sample

We define the parameters of the i.i.d. random sample with:
```{r}
n <- 100

# we sample n times from various univariate distributions
x1 <- rnorm(n, mean=0, sd=10)
x2 <- x1 + rexp(n, rate = 1)
x3 <- x2 + rpois(n, lambda = 1)
x4 <- x1 + rnorm(n, mean = 0, sd = 3)
x5 <- x3 + rnorm(n, mean = 0, sd = 3)

# now we combine them into a matrix
data <- cbind(x1, x2, x3, x4, x5)
```

We have observed a sample of size $n=`r n`$.
We show some observations from this sample with:
```{r}
head(data, n = 8)
```


```{r emp-test}
emp <- empirical_dist(data)

cov(data)
colMeans(data)

mean(emp)
vcov(emp)

support <- sup(emp)
infimum(support)
supremum(support)
dim(support)
```


```{r marginal-test}
X1 <- marginal(emp, 1)
F1 <- cdf(X1)
curve(F1(x), from = infimum(sup(X1)), to = supremum(sup(X1)))


X3 <- marginal(emp, 3)
F3 <- cdf(X3)
curve(F3(x), from = infimum(sup(X3)), to = supremum(sup(X3)))

X2X4 <- marginal(emp, c(2, 4))
rv <- sampler(X2X4)

# sample some data; could just use data directly
dataX2X4 <- rv(1000)

# scatter plot a 2d sample
plot(dataX2X4[,1], dataX2X4[,2], pch = 20, col = "blue")
```

